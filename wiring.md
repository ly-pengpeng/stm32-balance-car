# STM32F103C8T6 平衡小车接线说明

## 硬件连接图

### 核心连接
- **STM32F103C8T6** (蓝桥杯开发板)
- **MPU6050** 六轴传感器 (I2C接口)
- **TB6612FNG** 或 **L298N** 电机驱动模块
- **N20直流减速电机** x2 (带编码器)
- **7.4V锂电池** 供电系统

## 详细接线表

### MPU6050 连接 (I2C)
| MPU6050引脚 | STM32引脚 | 功能 |
|------------|-----------|------|
| VCC        | 3.3V      | 电源 |
| GND        | GND       | 地线 |
| SCL        | PB6       | I2C时钟 |
| SDA        | PB7       | I2C数据 |

### 电机驱动连接 (TB6612FNG)
| TB6612引脚 | STM32引脚 | 功能 |
|------------|-----------|------|
| VM         | 7.4V+     | 电机电源 |
| VCC        | 5V        | 逻辑电源 |
| GND        | GND       | 地线 |
| AIN1       | PA9       | 左电机方向1 |
| AIN2       | PA8       | 左电机方向2 |
| PWMA       | PA8(TIM1) | 左电机PWM |
| BIN1       | PA11      | 右电机方向1 |
| BIN2       | PA10      | 右电机方向2 |
| PWMB       | PA10(TIM1)| 右电机PWM |
| STBY       | 5V        | 使能引脚 |

### 编码器连接
| 编码器 | STM32引脚 | 功能 |
|--------|-----------|------|
| 左A相  | PA0       | TIM2编码器A |
| 左B相  | PA1       | TIM2编码器B |
| 右A相  | PA6       | TIM3编码器A |
| 右B相  | PA7       | TIM3编码器B |

### 串口调试连接
| 功能 | STM32引脚 | 说明 |
|------|-----------|------|
| TX   | PA9       | 串口发送 |
| RX   | PA10      | 串口接收 |

### 其他接口
| 功能 | STM32引脚 | 说明 |
|------|-----------|------|
| LED  | PC13      | 状态指示灯 |
| 按键 | PA0       | 启动/停止按钮 |

## 电源连接

1. **锂电池** → **电机驱动模块** (VM引脚)
2. **开发板5V输出** → **电机驱动VCC** (逻辑电源)
3. **开发板3.3V输出** → **MPU6050 VCC**
4. **所有GND共地**

## 注意事项

1. **电机电源隔离**: 电机电源和逻辑电源要分开，避免电机干扰
2. **编码器接线**: 确保A、B相正确连接，否则速度检测会出错
3. **I2C上拉电阻**: 如果MPU6050模块没有上拉电阻，需要在SCL和SDA上加4.7k上拉
4. **PWM频率**: 设置为1kHz，适合大多数直流电机
5. **安全保护**: 建议在电源输入端加入保险丝和开关

## 测试步骤

1. 先不接电机，测试MPU6050数据读取
2. 单独测试电机转动方向
3. 测试编码器计数功能
4. 最后进行整体平衡测试

## 常见问题

- **电机不转**: 检查STBY引脚是否使能
- **MPU6050无数据**: 检查I2C地址(0x68)和上拉电阻
- **编码器计数错误**: 检查A、B相接线顺序
- **通信失败**: 检查串口波特率设置(115200)